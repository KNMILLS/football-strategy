{"version":3,"file":"penaltyTables-CtArJ56i.js","sources":["../../src/data/loaders/penaltyTables.ts"],"sourcesContent":["import { PenaltyTableSchema, type PenaltyTable } from '../schemas/MatchupTable';\r\nimport { validatePenaltyTable } from '../schemas/validators';\r\nimport type { Result } from './Result';\r\nimport { fetchJson, getOrFetch, ok, err } from './http';\r\n\r\n/**\r\n * Fetches and validates a penalty table from the given path\r\n */\r\nexport async function fetchPenaltyTable(tablePath: string): Promise<Result<PenaltyTable>> {\r\n  const key = `data/${tablePath}`;\r\n\r\n  return getOrFetch(key, async () => {\r\n    const jsonRes = await fetchJson<unknown>(key);\r\n    if (!jsonRes.ok) return jsonRes;\r\n\r\n    // Parse with Zod schema\r\n    const parsed = PenaltyTableSchema.safeParse(jsonRes.data);\r\n    if (!parsed.success) {\r\n      return err('SCHEMA', `Invalid penalty table format: ${parsed.error.message}`);\r\n    }\r\n\r\n    // Run business logic validation\r\n    const validation = validatePenaltyTable(parsed.data);\r\n    if (!validation.valid) {\r\n      return err('VALIDATION', `Penalty table validation failed: ${validation.errors.join(', ')}`);\r\n    }\r\n\r\n    return ok(parsed.data);\r\n  });\r\n}\r\n\r\n/**\r\n * Fetches a penalty table by name\r\n */\r\nexport async function fetchPenaltyTableByName(tableName: string): Promise<Result<PenaltyTable>> {\r\n  // Convert table name to file path format\r\n  const formattedName = tableName.toLowerCase().replace(/[^a-z0-9]/g, '_');\r\n  const tablePath = `penalties/${formattedName}.json`;\r\n  return fetchPenaltyTable(tablePath);\r\n}\r\n"],"names":["fetchPenaltyTable","tablePath","key","getOrFetch","jsonRes","fetchJson","parsed","PenaltyTableSchema","err","validation","validatePenaltyTable","ok","fetchPenaltyTableByName","tableName"],"mappings":"gHAQA,eAAsBA,EAAkBC,EAAkD,CACxF,MAAMC,EAAM,QAAQD,CAAS,GAE7B,OAAOE,EAAWD,EAAK,SAAY,CACjC,MAAME,EAAU,MAAMC,EAAmBH,CAAG,EAC5C,GAAI,CAACE,EAAQ,GAAI,OAAOA,EAGxB,MAAME,EAASC,EAAmB,UAAUH,EAAQ,IAAI,EACxD,GAAI,CAACE,EAAO,QACV,OAAOE,EAAI,SAAU,iCAAiCF,EAAO,MAAM,OAAO,EAAE,EAI9E,MAAMG,EAAaC,EAAqBJ,EAAO,IAAI,EACnD,OAAKG,EAAW,MAITE,EAAGL,EAAO,IAAI,EAHZE,EAAI,aAAc,oCAAoCC,EAAW,OAAO,KAAK,IAAI,CAAC,EAAE,CAI/F,CAAC,CACH,CAKA,eAAsBG,EAAwBC,EAAkD,CAG9F,MAAMZ,EAAY,aADIY,EAAU,YAAA,EAAc,QAAQ,aAAc,GAAG,CAC3B,QAC5C,OAAOb,EAAkBC,CAAS,CACpC"}