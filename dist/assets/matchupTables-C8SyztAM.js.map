{"version":3,"file":"matchupTables-C8SyztAM.js","sources":["../../src/data/loaders/matchupTables.ts"],"sourcesContent":["import { MatchupTableSchema, type MatchupTable } from '../schemas/MatchupTable';\r\nimport { validateMatchupTable } from '../schemas/validators';\r\nimport type { Result } from './Result';\r\nimport { fetchJson, getOrFetch, ok, err } from './http';\r\n\r\n/**\r\n * Fetches and validates a matchup table from the given path\r\n */\r\nexport async function fetchMatchupTable(tablePath: string): Promise<Result<MatchupTable>> {\r\n  const key = `data/${tablePath}`;\r\n\r\n  return getOrFetch(key, async () => {\r\n    const jsonRes = await fetchJson<unknown>(key);\r\n    if (!jsonRes.ok) return jsonRes;\r\n\r\n    // Parse with Zod schema\r\n    const parsed = MatchupTableSchema.safeParse(jsonRes.data);\r\n    if (!parsed.success) {\r\n      return err('SCHEMA', `Invalid matchup table format: ${parsed.error.message}`);\r\n    }\r\n\r\n    // Run business logic validation\r\n    const validation = validateMatchupTable(parsed.data);\r\n    if (!validation.valid) {\r\n      return err('VALIDATION', `Matchup table validation failed: ${validation.errors.join(', ')}`);\r\n    }\r\n\r\n    return ok(parsed.data);\r\n  });\r\n}\r\n\r\n/**\r\n * Fetches a matchup table by offensive and defensive card names\r\n */\r\nexport async function fetchMatchupTableByCards(offCard: string, defCard: string): Promise<Result<MatchupTable>> {\r\n  // Convert card names to file path format\r\n  const offCardFormatted = offCard.toLowerCase().replace(/[^a-z0-9]/g, '_');\r\n  const defCardFormatted = defCard.toLowerCase().replace(/[^a-z0-9]/g, '_');\r\n  const tablePath = `${offCardFormatted}__${defCardFormatted}.json`;\r\n\r\n  return fetchMatchupTable(tablePath);\r\n}\r\n"],"names":["fetchMatchupTable","tablePath","key","getOrFetch","jsonRes","fetchJson","parsed","MatchupTableSchema","err","validation","validateMatchupTable","ok","fetchMatchupTableByCards","offCard","defCard","offCardFormatted","defCardFormatted"],"mappings":"2GAQA,eAAsBA,EAAkBC,EAAkD,CACxF,MAAMC,EAAM,QAAQD,CAAS,GAE7B,OAAOE,EAAWD,EAAK,SAAY,CACjC,MAAME,EAAU,MAAMC,EAAmBH,CAAG,EAC5C,GAAI,CAACE,EAAQ,GAAI,OAAOA,EAGxB,MAAME,EAASC,EAAmB,UAAUH,EAAQ,IAAI,EACxD,GAAI,CAACE,EAAO,QACV,OAAOE,EAAI,SAAU,iCAAiCF,EAAO,MAAM,OAAO,EAAE,EAI9E,MAAMG,EAAaC,EAAqBJ,EAAO,IAAI,EACnD,OAAKG,EAAW,MAITE,EAAGL,EAAO,IAAI,EAHZE,EAAI,aAAc,oCAAoCC,EAAW,OAAO,KAAK,IAAI,CAAC,EAAE,CAI/F,CAAC,CACH,CAKA,eAAsBG,EAAyBC,EAAiBC,EAAgD,CAE9G,MAAMC,EAAmBF,EAAQ,YAAA,EAAc,QAAQ,aAAc,GAAG,EAClEG,EAAmBF,EAAQ,YAAA,EAAc,QAAQ,aAAc,GAAG,EAClEb,EAAY,GAAGc,CAAgB,KAAKC,CAAgB,QAE1D,OAAOhB,EAAkBC,CAAS,CACpC"}