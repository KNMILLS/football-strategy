import{_ as O,s as f,r as g,o as d,a as j,u as w,n as r,b as L,l as $}from"./vendor-B3BKSCLF.js";const D=O(["A","B","C","D","E","F","G","H","I","J"]),F=f(),H=g(D,F),S=g(f(),H),E=d({ProStyle:S,BallControl:S,AerialStyle:S}),z=d({OffenseCharts:E}),h=new Map;function k(t){return{ok:!0,data:t}}function m(t,a){return{ok:!1,error:{code:t,message:a}}}function W(){h.clear()}async function A(t){try{const a=await fetch(t);if(!a.ok)return m("HTTP",`status ${a.status} for ${t}`);const n=await a.json();return k(n)}catch(a){return m("HTTP",`failed to fetch ${t}: ${a?.message??String(a)}`)}}async function v(t,a){if(h.has(t))return h.get(t);const n=await a();return h.set(t,n),n}async function K(){const t="data/football_strategy_all_mappings.json";return v(t,async()=>{const a=await A(t);if(!a.ok)return a;const n=z.safeParse(a.data);if(!n.success)return m("SCHEMA",n.error.message);try{return k(n.data.OffenseCharts)}catch(e){return m("TRANSFORM",e?.message??"failed to extract OffenseCharts")}})}const B=g(f(),O(["G","NG"])),b=g(f().regex(/^\d+$/),B),q=d({name:f(),dice:f(),columns:j(d({range:f(),min:r().nullable().optional(),max:r().nullable().optional()})),results:j(g(f(),w([f(),r(),L()])))}),C=w([b,q]);function I(t){const a=C.safeParse(t);if(a.success){const n=a.data;if(n&&typeof n=="object"&&!("results"in n)){const e=b.safeParse(n);if(e.success){const s=Object.keys(e.data||{});return s.length===0||!s.some(u=>typeof e.data[u]?.PAT=="string")?void 0:e.data}}try{const e=Array.isArray(n?.columns)?n.columns.map(i=>i?.range).filter(i=>typeof i=="string"):[],s=Array.isArray(n?.results)?n.results:[];if(e.length===0||s.length===0)return;const o={};for(const i of s){const p=String(i.roll);if(!/^(?:[1-9]|1[0-2])$/.test(p))continue;const y={};for(const _ of e){const T=i[_];(T==="G"||T==="NG")&&(y[_]=T)}o[p]=y}const u=b.safeParse(o);if(!u.success)return;const l=Object.keys(u.data||{});return l.length===0||!(e.includes("PAT")&&l.some(i=>typeof u.data[i]?.PAT=="string"))?void 0:u.data}catch{return}}try{const n=Array.isArray(t?.columns)?t.columns.map(c=>c?.range).filter(c=>typeof c=="string"):[],e=Array.isArray(t?.results)?t.results:[];if(n.length===0||e.length===0)return;const s={};for(const c of e){const i=String(c.roll);if(!/^(?:[1-9]|1[0-2])$/.test(i))continue;const p={};for(const y of n){const _=c[y];(_==="G"||_==="NG")&&(p[y]=_)}s[i]=p}const o=b.safeParse(s);if(!o.success)return;const u=Object.keys(o.data||{});return u.length===0||!(n.includes("PAT")&&u.some(c=>typeof o.data[c]?.PAT=="string"))?void 0:o.data}catch{return}}async function R(){const t="data/place_kicking.json";return v(t,async()=>{const a=await A(t);if(!a.ok)return a;const n=I(a.data);if(!n){const e=C.safeParse(a.data);return e.success?m("TRANSFORM","failed to normalize place-kicking table"):m("SCHEMA",e.error.message)}return k(n)})}const P=d({gain0to20:r(),gain20plus:r(),loss:r(),outOfBounds:r(),incomplete:r(),interception:r(),penalty:r(),fumble:r(),kickoff:r(),fieldgoal:r(),punt:r(),extraPoint:r()}),J=d({name:f(),units:f(),rules:j(d({event:f(),duration:r().optional(),adjustment:r().optional()}))}),N=w([P,J]);function Y(t){const a=N.safeParse(t);if(a.success){const n=a.data;if(n&&typeof n=="object"&&!("rules"in n)){const e=P.safeParse(n);if(e.success)return e.data}try{const e=Array.isArray(n?.rules)?n.rules:[],s=i=>e.find(p=>p?.event===i)||{},o=i=>typeof i=="number"?Math.abs(i):0;if(!["gain_in_bounds_0_to_20","gain_in_bounds_20_plus","all_plays_for_loss","out_of_bounds","incomplete_pass","interception","penalty","fumble","kickoff_fg_punt_in_bounds","extra_point"].some(i=>!!s(i).event))return;const l={gain0to20:Number(s("gain_in_bounds_0_to_20").duration)||30,gain20plus:Number(s("gain_in_bounds_20_plus").duration)||45,loss:Number(s("all_plays_for_loss").duration)||30,outOfBounds:o(s("out_of_bounds").adjustment)||15,incomplete:o(s("incomplete_pass").adjustment)||15,interception:o(s("interception").adjustment)||30,penalty:o(s("penalty").adjustment)||15,fumble:o(s("fumble").adjustment)||15,kickoff:o(s("kickoff_fg_punt_in_bounds").adjustment)||15,fieldgoal:o(s("kickoff_fg_punt_in_bounds").adjustment)||15,punt:o(s("kickoff_fg_punt_in_bounds").adjustment)||15,extraPoint:o(s("extra_point").adjustment)||0},c=P.safeParse(l);return c.success?c.data:void 0}catch{return}}try{const n=Array.isArray(t?.rules)?t.rules:[],e=l=>n.find(c=>c?.event===l)||{},s=l=>typeof l=="number"?Math.abs(l):0;if(!Array.isArray(t?.rules)||t.rules.length===0)return;const o={gain0to20:Number(e("gain_in_bounds_0_to_20").duration)||30,gain20plus:Number(e("gain_in_bounds_20_plus").duration)||45,loss:Number(e("all_plays_for_loss").duration)||30,outOfBounds:s(e("out_of_bounds").adjustment)||15,incomplete:s(e("incomplete_pass").adjustment)||15,interception:s(e("interception").adjustment)||30,penalty:s(e("penalty").adjustment)||15,fumble:s(e("fumble").adjustment)||15,kickoff:s(e("kickoff_fg_punt_in_bounds").adjustment)||15,fieldgoal:s(e("kickoff_fg_punt_in_bounds").adjustment)||15,punt:s(e("kickoff_fg_punt_in_bounds").adjustment)||15,extraPoint:s(e("extra_point").adjustment)||0},u=P.safeParse(o);return u.success?u.data:void 0}catch{return}}async function x(){const t="data/time_keeping.json";return v(t,async()=>{const a=await A(t);if(!a.ok)return a;const n=Y(a.data);if(!n){const e=N.safeParse(a.data);return e.success?m("TRANSFORM","failed to normalize timekeeping table"):m("SCHEMA",e.error.message)}return k(n)})}const Q=d({baseYards:r(),extra:d({die:$("1d6"),multiplier:r()}).optional()}),G=d({results:g(f().regex(/^[1-6]$/),Q)});function U(t){const a=G.safeParse(t);if(a.success)return a.data.results}async function M(){const t="data/long_gain.json";return v(t,async()=>{const a=await A(t);if(!a.ok)return a;const n=U(a.data);if(!n){const e=G.safeParse(a.data);return e.success?m("TRANSFORM","failed to extract long gain results"):m("SCHEMA",e.error.message)}return k(n)})}async function X(){const t=await K();return t.ok?t.data:void 0}async function Z(){const t=await R();return t.ok?t.data:void 0}async function tt(){const t=await x();return t.ok?t.data:void 0}async function et(){const t=await M();return t.ok?t.data:void 0}async function nt(){const t=await K();return t.ok?t.data:void 0}async function at(){const t=await R();return t.ok?t.data:void 0}async function st(){const t=await x();return t.ok?t.data:void 0}async function ot(){const t=await M();return t.ok?t.data:void 0}export{W as clearTablesCache,M as fetchLongGain,K as fetchOffenseCharts,R as fetchPlaceKicking,x as fetchTimeKeeping,et as loadLongGain,ot as loadLongGainDeprecated,X as loadOffenseCharts,nt as loadOffenseChartsDeprecated,Z as loadPlaceKicking,at as loadPlaceKickingDeprecated,tt as loadTimeKeeping,st as loadTimeKeepingDeprecated};
//# sourceMappingURL=tables-BYyVGAGB.js.map
